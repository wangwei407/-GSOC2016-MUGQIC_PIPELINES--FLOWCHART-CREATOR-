<!DOCTYPE html>
<html lang="en-us">
  <head>
    <meta charset="UTF-8">
    <title>Gsoc2016-mugqic pipelines--flowchart-creator by wangwei407</title>
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <link rel="stylesheet" type="text/css" href="stylesheets/normalize.css" media="screen">
    <link href='https://fonts.googleapis.com/css?family=Open+Sans:400,700' rel='stylesheet' type='text/css'>
    <link rel="stylesheet" type="text/css" href="stylesheets/stylesheet.css" media="screen">
    <link rel="stylesheet" type="text/css" href="stylesheets/github-light.css" media="screen">
  </head>
  <body>
    <section class="page-header">
      <h1 class="project-name">Gsoc2016-mugqic pipelines--flowchart-creator</h1>
      <h2 class="project-tagline"></h2>
      <a href="https://github.com/wangwei407/GSOC2016-MUGQIC_PIPELINES--FLOWCHART-CREATOR" class="btn">View on GitHub</a>
      <a href="https://github.com/wangwei407/GSOC2016-MUGQIC_PIPELINES--FLOWCHART-CREATOR/zipball/master" class="btn">Download .zip</a>
      <a href="https://github.com/wangwei407/GSOC2016-MUGQIC_PIPELINES--FLOWCHART-CREATOR/tarball/master" class="btn">Download .tar.gz</a>
    </section>

    <section class="main-content">
      <h1>
<a id="guideline-for-student-application" class="anchor" href="#guideline-for-student-application" aria-hidden="true"><span aria-hidden="true" class="octicon octicon-link"></span></a>Guideline for student application</h1>

<h2>
<a id="general-guidelines" class="anchor" href="#general-guidelines" aria-hidden="true"><span aria-hidden="true" class="octicon octicon-link"></span></a>General guidelines</h2>

<ul>
<li><p>Applications that do not contain at least the minimum information in the template <strong>will not</strong> get a slot.</p></li>
<li><p>The best applications run to several pages (10+) if printed, and show considerable thought and planning.  The application process is longer this year than it has been in some prior years, so this should not be a problem.</p></li>
<li><p>Be sure to follow the general guidelines available in the <a href="http://write.flossmanuals.net/gsocstudentguide/writing-a-proposal/">GSoC student guide</a>.</p></li>
<li><p>If you have questions about details, contact your mentors first.  If you still have choices to make or different possible approaches, explore the most likely ones in your application. The goal of your application is to demonstrate your capability to complete the work of the project over the course of the summer, demonstrate that you've given a fair amount of thought to an implementation approach, and plan, as much as possible, for choices that may change the goals or timeline in the application.</p></li>
<li><p>Once your draft application has been submitted, you may receive comments from other C3G mentors, either listed project mentors or others.  Please respond to the comments promptly and completely.  Being non-responsive before you've even been awarded a slot is not a good sign for the success of your proposal.</p></li>
<li><p>Originality is always welcomed. If you have improvement ideas that go beyong the proposed project scope, by all means include them in your proposal.</p></li>
</ul>

<h2>
<a id="project-info" class="anchor" href="#project-info" aria-hidden="true"><span aria-hidden="true" class="octicon octicon-link"></span></a>Project Info</h2>

<p>Project title: <strong>Flowchart creator for MUGQIC Pipelines</strong><br>
Project short title (30 characters): <strong>Flowchart creator</strong><br>
URL of project idea page: <a href="https://bitbucket.org/mugqic/gsoc2016#markdown-header-flowchart-creator-for-mugqic-pipelines">idea link</a>  </p>

<h2>
<a id="biographical-information" class="anchor" href="#biographical-information" aria-hidden="true"><span aria-hidden="true" class="octicon octicon-link"></span></a>Biographical Information</h2>

<p>Provide a brief (text) biography, and why you think your background qualifies you for this project.<br>
I am a graduate student pursuing MS in Information System for Big Data and Predictive Analytics Track at <a href="http://wustl.edu">Washington university in St.Louis</a>. I was an undergraduate student at Anhui University of Technology in Information system major. Though I am an information system student, I got a solid programming knowledge structure (programming skills, data structure and algorithm, OS organization) when I was in China.</p>

<h3>
<a id="why-i-think-my-background-qualifies-me-for-this-project" class="anchor" href="#why-i-think-my-background-qualifies-me-for-this-project" aria-hidden="true"><span aria-hidden="true" class="octicon octicon-link"></span></a>Why I think my background qualifies me for this project.</h3>

<ul>
<li>I have a solid background of python and OS organization(unix) which help me to be familiar with MUGQICPipeline structure quickly.<br>
</li>
<li>In addition, in my free time, I have experienced in using Graphviz software and I hava learned the basic knowledge of pipeline flowchart.</li>
<li>I have experienced in github and bitbucket.</li>
</ul>

<h3>
<a id="why-i-choose-this-project" class="anchor" href="#why-i-choose-this-project" aria-hidden="true"><span aria-hidden="true" class="octicon octicon-link"></span></a>Why I choose this project</h3>

<ul>
<li>I am interested in MUGQICPipeline structure. It is the first time for me to know how to control pipeline on clusters with python.</li>
<li>I am a studious student and my major is data analysis. So I think in the future I can help the community to develop other tools with my major knowledge. </li>
<li>I think that pipeline flowchart idea is a cool idea, which makes MUGQICPipeline more user-friendly and concrete.</li>
<li>I really love this project and the mentor of this project is very kind and patience.</li>
</ul>

<h2>
<a id="contact-information" class="anchor" href="#contact-information" aria-hidden="true"><span aria-hidden="true" class="octicon octicon-link"></span></a>Contact Information</h2>

<p>Student name: Wei Wang</p>

<p>Melange Link_id:  </p>

<p>Student postal address: 304N SKINKER BLVD, APT 3S, ST.LOUIS, MO, U.S.</p>

<p>Telephone(s): +1 314-541-5129 or +86 139-3399-7555</p>

<p>Email(s): <a href="mailto:wangwei407@wustl.edu">wangwei407@wustl.edu</a> or <a href="mailto:wei0301wang@gmail.com">wei0301wang@gmail.com</a></p>

<p>Other communications channels: Skype/Google+, etc. : </p>

<h2>
<a id="student-affiliation" class="anchor" href="#student-affiliation" aria-hidden="true"><span aria-hidden="true" class="octicon octicon-link"></span></a>Student Affiliation</h2>

<p>University: Washington Univisity in St.Louis  </p>

<p>School: School of Engineering &amp; Applied Science</p>

<p>Program: M.S in Information System</p>

<p>Stage of completion: second year</p>

<p>Contact to verify: There is an automatically generated <a href="http://52.36.214.116/%7Ewangwei407/gsoc2016/Information.pdf">PDF</a> from my university account.</p>

<h2>
<a id="schedule-conflicts" class="anchor" href="#schedule-conflicts" aria-hidden="true"><span aria-hidden="true" class="octicon octicon-link"></span></a>Schedule Conflicts</h2>

<p>This summer, I don't have any other internships or plans, so I can contuibute all my time to this project.</p>

<h2>
<a id="mentors" class="anchor" href="#mentors" aria-hidden="true"><span aria-hidden="true" class="octicon octicon-link"></span></a>Mentors</h2>

<p>Mentor names: Johanna Sandoval</p>

<p>Mentor emails: <a href="mailto:johanna.sandoval@computationalgenomics.ca">johanna.sandoval@computationalgenomics.ca</a></p>

<p>Mentor link_ids: </p>

<p>Have you been in touch with the mentors? When and how? 
Yes, I have been in touch with mentors Johanna and Mathieu through E-maill. And I disscussed some technology issues with mentor Jonhanna, she gives me some very usefull directions and clues about how to merge my module into the MUGQICPipeline software.</p>

<h2>
<a id="synopsis-max-150-words" class="anchor" href="#synopsis-max-150-words" aria-hidden="true"><span aria-hidden="true" class="octicon octicon-link"></span></a>Synopsis (max 150 words)</h2>

<p>MUGQIC_PIPELINE program maintains 7 different kinds of pipelines and currently develops 3 others, and each of them contains 10 to 40 steps. My project is an integrated system which will automatically output flowchart based on different steps (e.g 1-20 or 1,4,9,11,20,21-30) and kinds of pipeline (e.g dnaseq,rnaseq) when pipeline is called.</p>

<h2>
<a id="benefits-to-community-max-250-words" class="anchor" href="#benefits-to-community-max-250-words" aria-hidden="true"><span aria-hidden="true" class="octicon octicon-link"></span></a>Benefits to Community (max 250 words)</h2>

<p>Flowchart creator is a user-friendly add-on to MUGQIC_PIPELINE. As metioned in <strong>Synopsis</strong>, MUGQIC_PIPELINE has many different kinds of pipelines and user can decide steps range, in this case, a flowchart contains all information which make MUGQIC_PIPELINE software more user-friendly and concrete. For example, flowchart contains start node (contains pipeline type,time and output path), step node (e.g. step1:convert BAM to FASTQ files), input/output node (e.g. BAM/FAST files) and action node (tell user what action dose the step do). Plus, I will make an integrated Flowchart creator API in pipeline base class so that it will has no requirement that changing the pipeline class in order to add new type pipeline in future. </p>

<h2>
<a id="coding-plan--methods" class="anchor" href="#coding-plan--methods" aria-hidden="true"><span aria-hidden="true" class="octicon octicon-link"></span></a>Coding Plan &amp; Methods</h2>

<p>Describe perceived obstacles and challenges, and how you plan to overcome them.</p>

<h3>
<a id="coding-objective" class="anchor" href="#coding-objective" aria-hidden="true"><span aria-hidden="true" class="octicon octicon-link"></span></a>Coding objective:</h3>

<p>A Flowchart Creator API which is merged into pipeline base class.</p>

<h3>
<a id="dependencies" class="anchor" href="#dependencies" aria-hidden="true"><span aria-hidden="true" class="octicon octicon-link"></span></a>dependencies</h3>

<h4>
<a id="graphviz" class="anchor" href="#graphviz" aria-hidden="true"><span aria-hidden="true" class="octicon octicon-link"></span></a><a href="http://www.graphviz.org">Graphviz</a>
</h4>

<p>Graphviz is open source graph visualization software. Graph visualization is a way of representing structural information as diagrams of abstract graphs and networks. It has important applications in networking, bioinformatics,  software engineering, database and web design, machine learning, and in visual interfaces for other technical domains. 
Graphviz consists of a graph description language named the <a href="https://en.wikipedia.org/wiki/DOT_(graph_description_language)">DOT language</a> and a set of tools that can generate and/or process.
<strong>Why I choose Graphviz:</strong></p>

<ul>
<li>Graphviz is a mature, stable, open-source and free of charge software. Though it is not a dedicated flowchart or diagramming package, but it's core use case--i.e, efficient and asethetic rendering of objects comprised of nodes and edges, obviously subsumes flowchart drawing</li>
<li>Graphviz has it's own algorithm to automatically arrange nodes and edge.</li>
<li>Graphviz provide <a href="http://www.graphviz.org/doc/info/attrs.html">many attributes</a> to nodes, edges, subgraph. Such as color, size, font, style and url (e.g. When user click on the Trimmoatic node, flowchart will redirect user to trimmomatic <a href="http://www.usadellab.org/cms/index.php?page=trimmomatic">documentation</a> website)</li>
<li>Graphviz consists of DOT language which is an easy and concise language to depict a directed graph.</li>
<li>For example,<br>
</li>
</ul>

<div class="highlight highlight-source-dot"><pre>  <span class="pl-k">digraph</span> <span class="pl-smi">G</span> {  
  <span class="pl-s"><span class="pl-pds">"</span>MUGQIC PIPELINE START!<span class="pl-pds">"</span></span><span class="pl-k">-&gt;</span><span class="pl-s"><span class="pl-pds">"</span>run step<span class="pl-pds">"</span></span>  
  <span class="pl-s"><span class="pl-pds">"</span>run step<span class="pl-pds">"</span></span><span class="pl-k">-&gt;</span><span class="pl-s"><span class="pl-pds">"</span>END<span class="pl-pds">"</span></span>
  }    
  This is an easy directed <span class="pl-k">graph</span> contains 3 nodes, and two edges (<span class="pl-k">-&gt;</span> connects two nodes)</pre></div>

<h4>
<a id="pydot" class="anchor" href="#pydot" aria-hidden="true"><span aria-hidden="true" class="octicon octicon-link"></span></a><a href="http://code.google.com/p/pydot/">pydot</a>
</h4>

<p>a python interface to graphviz software<br>
<strong>Why I choose pydot</strong>  </p>

<ul>
<li>Pydot is an <strong>open-source</strong> and <strong>light-weighted</strong> python interface to graphviz, the mechanism of pydot is to transfer python code to DOT language and call Graphviz to output the graph.<br>
For example, use python module pydot to draw the graph<br>
</li>
</ul>

<div class="highlight highlight-source-python"><pre><span class="pl-k">import</span> pydot  
Graph<span class="pl-k">=</span>pydot.Dot() <span class="pl-c">#create a dot object  </span>
edge1<span class="pl-k">=</span>pydot.Edge(<span class="pl-s"><span class="pl-pds">'</span>MUGQIC PIPELINE START<span class="pl-pds">'</span></span>,<span class="pl-s"><span class="pl-pds">'</span>run step<span class="pl-pds">'</span></span>)  <span class="pl-c">#create a edge between node1 and node2  </span>
edge2<span class="pl-k">=</span>pydot.Edge(<span class="pl-s"><span class="pl-pds">'</span>run step<span class="pl-pds">'</span></span>,<span class="pl-s"><span class="pl-pds">'</span>END<span class="pl-pds">'</span></span>)  
Graph.add_edge(edge1) <span class="pl-c">#add edge1 to Graph  </span>
Graph.add_edge(edge2)  
Graph.write_png(<span class="pl-s"><span class="pl-pds">'</span>example.png<span class="pl-pds">'</span></span>) <span class="pl-c">#output a png graph named 'example'  </span></pre></div>

<p><img src="http://52.36.214.116/%7Ewangwei407/gsoc2016/example.png" alt="example.png">  </p>

<h4>
<a id="merge-graphviz-and-python-module-into-mugqicpipeline-thanks-to-mentor-johanna-giving-me-correct-direction-and-clues" class="anchor" href="#merge-graphviz-and-python-module-into-mugqicpipeline-thanks-to-mentor-johanna-giving-me-correct-direction-and-clues" aria-hidden="true"><span aria-hidden="true" class="octicon octicon-link"></span></a>Merge Graphviz and python module into MUGQICPipeline (Thanks to mentor Johanna giving me correct direction and clues)</h4>

<blockquote>
<p>Add pydot into resources.python_lib.sh and write a bash script Graphviz.sh to install Graphviz software in MUGQICPipeline software</p>
</blockquote>

<h3>
<a id="flowchart-creator-api-structure--challenge-thanks-to-mentor-johanna-giving-me-correct-direction-and-clues" class="anchor" href="#flowchart-creator-api-structure--challenge-thanks-to-mentor-johanna-giving-me-correct-direction-and-clues" aria-hidden="true"><span aria-hidden="true" class="octicon octicon-link"></span></a>Flowchart Creator API structure  (challenge) (Thanks to mentor Johanna giving me correct direction and clues)</h3>

<p>I have observed that MUGQIC_PIPELINE software has 7 kinds of pipeline, and the pipeline class structures are as follows:<br>
<img src="http://52.36.214.116/%7Ewangwei407/gsoc2016/class.png" alt="class.png"><br>
<strong>In this case, Flowchart Creator API will have 7 kinds of flowchart creator classes and has the same hierarchy as MUGQIC_PIPELINE:</strong>  </p>

<div class="highlight highlight-source-python"><pre><span class="pl-c1">1</span>. <span class="pl-k">class</span> MUGQICPipelineCreator  <span class="pl-c">#base class for all creator class</span>
<span class="pl-c1">2</span>. <span class="pl-k">class</span> IlluminaRunProcessingCreator(MUGQICPipelineCreator) <span class="pl-c">#(match a pipeline tool)  </span>
<span class="pl-c1">3</span>. <span class="pl-k">class</span> BioAssemblyPacoCreator(MUGQICPipelineCreator)  <span class="pl-c">#(match a pipeline tool)    </span>
<span class="pl-c1">4</span>. <span class="pl-k">class</span> IlluminaCreator(MUGQICPipelineCreator) <span class="pl-c">#This class is not a pipeline tool, but it is the parent class for DnaSeq, RnaSeq.    </span>
<span class="pl-c1">5</span>. <span class="pl-k">class</span> DnaSeqCreator(IlluminaCreator)  <span class="pl-c">#(match a pipeline tool)  </span>
<span class="pl-c1">6</span>. <span class="pl-k">class</span> RnaSeqCreator(IlluminaCreator)  <span class="pl-c">#(match a pipeline tool)  </span>
<span class="pl-c1">7</span>. <span class="pl-k">class</span> RnaSeqDeNovoAssemblyCreator(IlluminaCreator)  <span class="pl-c">#(match a pipeline tool)  </span>
<span class="pl-c1">8</span>. <span class="pl-k">class</span> ChiSeqCreator(DnaSeqCreator) <span class="pl-c">#(match a pipeline tool)  </span>
<span class="pl-c1">9</span>. <span class="pl-k">class</span> DnaSeqHighCoverageCreator(DnaSeqCreator) <span class="pl-c">#(match a pipeline tool)  </span></pre></div>

<blockquote>
<ol>
<li>Every Creator class which match a pipeline tool has the same function name related to the step function in pipeline tool. For example, in illumina class, there is a step function "trimmomatic" which clean FASTQ files so that there will be a function named tremmomatic in IlluminaCreator to draw a related action, input/output node for this step.<br>
</li>
<li>Every Creator has a class method named draw_flowchart which receive a step name list and call self related functions to draw step nodes and connect them to output.<br>
</li>
</ol>
</blockquote>

<h3>
<a id="merge-every-creator-class-into-a-callable-factory-class" class="anchor" href="#merge-every-creator-class-into-a-callable-factory-class" aria-hidden="true"><span aria-hidden="true" class="octicon octicon-link"></span></a>Merge every Creator class into a callable factory class.</h3>

<h4>
<a id="register-every-creator-class-and-its-related-draw_flowchart-function-into-a-dict" class="anchor" href="#register-every-creator-class-and-its-related-draw_flowchart-function-into-a-dict" aria-hidden="true"><span aria-hidden="true" class="octicon octicon-link"></span></a>Register every creator class and its related draw_flowchart function into a dict</h4>

<div class="highlight highlight-source-python"><pre><span class="pl-k">from</span> abc <span class="pl-k">import</span> ABCMeta
<span class="pl-k">import</span> six
<span class="pl-c1">CREATOR_CLASSES</span><span class="pl-k">=</span>{}
<span class="pl-k">class</span> <span class="pl-en">CreatorRegistry</span>(<span class="pl-e">ABCMeta</span>):
        <span class="pl-s"><span class="pl-pds">'''</span></span>
<span class="pl-s">        metaclass to define creator class</span>
<span class="pl-s">        <span class="pl-pds">'''</span></span>
        registry <span class="pl-k">=</span> <span class="pl-c1">CREATOR_CLASSES</span>
        <span class="pl-k">def</span> <span class="pl-c1">__new__</span>(<span class="pl-smi">mcls</span>,<span class="pl-smi">name</span>,<span class="pl-smi">bases</span>,<span class="pl-smi">memebers</span>):
            <span class="pl-v">cls</span><span class="pl-k">=</span><span class="pl-c1">super</span>(CreatorRegistry,mcls).<span class="pl-c1">__new__</span>(mcls,name,bases,memebers)
            <span class="pl-k">if</span> <span class="pl-s"><span class="pl-pds">'</span>draw_flowchart<span class="pl-pds">'</span></span> <span class="pl-k">in</span> memebers:
                mcls.registry[<span class="pl-v">cls</span>.<span class="pl-c1">__name__</span>]<span class="pl-k">=</span><span class="pl-v">cls</span>.draw_flowchart <span class="pl-c">#store class name and draw_flowchart function in a dict</span>
            <span class="pl-k">return</span> <span class="pl-v">cls</span>
<span class="pl-en">@six.add_metaclass</span>(CreatorRegistry)
<span class="pl-k">class</span> <span class="pl-en">MUGQICPipelineCreator</span>:
        <span class="pl-k">pass</span></pre></div>

<blockquote>
<p>In this case, CREATOR_CLASSES will store all class name(key) and related class method draw_flowchart function(value).</p>
</blockquote>

<h4>
<a id="factory-class-to-merge-all-creator-class-callable" class="anchor" href="#factory-class-to-merge-all-creator-class-callable" aria-hidden="true"><span aria-hidden="true" class="octicon octicon-link"></span></a>Factory class to merge all Creator class callable</h4>

<div class="highlight highlight-source-python"><pre><span class="pl-k">class</span> <span class="pl-en">CreatorFactory</span>:
      <span class="pl-k">def</span> <span class="pl-c1">__init__</span>(<span class="pl-smi"><span class="pl-smi">self</span></span>):
         <span class="pl-v">self</span>.registry<span class="pl-k">=</span><span class="pl-c1">CREATOR_CLASSES</span> <span class="pl-c">#pass the rigistry CREATOR_CLASSES into CreatorFactory class</span>
      <span class="pl-k">def</span> <span class="pl-c1">__call__</span>(<span class="pl-smi">clsname</span>,<span class="pl-smi">steps</span>):  
          <span class="pl-s"><span class="pl-pds">'''</span></span>
<span class="pl-s">          @param receive a class name and step object list</span>
<span class="pl-s">          <span class="pl-pds">'''</span></span>
          <span class="pl-k">return</span> _check_class(clsname,steps)
      <span class="pl-k">def</span> <span class="pl-en">_check_class</span>(<span class="pl-smi">clsname</span>,<span class="pl-smi">steps</span>): 
          <span class="pl-v">self</span>.parse_params(steps) 
          Then search <span class="pl-v">self</span>.registry to find out matched clsname <span class="pl-k">and</span> call its related draw_flowchart function to output flowchart
      <span class="pl-k">def</span> <span class="pl-en">parse_params</span>(<span class="pl-smi">steps</span>):
          <span class="pl-s"><span class="pl-pds">'''</span></span>
<span class="pl-s">          transfer step object list to a step name (string) list</span>
<span class="pl-s">          <span class="pl-pds">'''</span></span>
          <span class="pl-k">pass</span>  
Creator<span class="pl-k">=</span>CreatorFactory() <span class="pl-c">#create a CreatorFactory object in order to merge Creator API to MUGQICPipeline Software</span></pre></div>

<h4>
<a id="merge-creator-api-into-mugqicpipeline-software" class="anchor" href="#merge-creator-api-into-mugqicpipeline-software" aria-hidden="true"><span aria-hidden="true" class="octicon octicon-link"></span></a>Merge Creator API into MUGQICPipeline software</h4>

<p>I have observed in core.Pipeline class init() function: </p>

<div class="highlight highlight-source-python"><pre><span class="pl-c1">104</span>.            <span class="pl-k">if</span> <span class="pl-v">self</span>.args.steps:
<span class="pl-c1">105</span>.                <span class="pl-k">if</span> re.search(<span class="pl-s"><span class="pl-pds">"</span>^\d+([,-]\d+)*$<span class="pl-pds">"</span></span>, <span class="pl-v">self</span>.args.steps):
<span class="pl-c1">106</span>.                    self._step_range <span class="pl-k">=</span> [<span class="pl-v">self</span>.step_list[i <span class="pl-k">-</span> <span class="pl-c1">1</span>] <span class="pl-k">for</span> i <span class="pl-k">in</span> parse_range(<span class="pl-v">self</span>.args.steps)]
<span class="pl-c1">107</span>.                <span class="pl-k">else</span>:
<span class="pl-c1">108</span>.                    <span class="pl-k">raise</span> <span class="pl-c1">Exception</span>(<span class="pl-s"><span class="pl-pds">"</span>Error: step range <span class="pl-cce">\"</span><span class="pl-pds">"</span></span> <span class="pl-k">+</span> <span class="pl-v">self</span>.args.steps <span class="pl-k">+</span>
<span class="pl-c1">109</span>.                        <span class="pl-s"><span class="pl-pds">"</span><span class="pl-cce">\"</span> is invalid (should match \d+([,-]\d+)*)!<span class="pl-pds">"</span></span>)
<span class="pl-c1">110</span>.            <span class="pl-k">else</span>:
<span class="pl-c1">111</span>.                self.argparser.error(<span class="pl-s"><span class="pl-pds">"</span>argument -s/--steps is required!<span class="pl-pds">"</span></span>)</pre></div>

<blockquote>
<p><code>self._step_range</code>is a parsed step object list. In this case, just add <code>from CreatorFactory import Creator</code> to the header and pass <code>self._step_range and class name</code>to Creator. Like this:</p>
</blockquote>

<div class="highlight highlight-source-python"><pre><span class="pl-c1">104</span>.            <span class="pl-k">if</span> <span class="pl-v">self</span>.args.steps:
<span class="pl-c1">105</span>.                <span class="pl-k">if</span> re.search(<span class="pl-s"><span class="pl-pds">"</span>^\d+([,-]\d+)*$<span class="pl-pds">"</span></span>, <span class="pl-v">self</span>.args.steps):
<span class="pl-c1">106</span>.                    self._step_range <span class="pl-k">=</span> [<span class="pl-v">self</span>.step_list[i <span class="pl-k">-</span> <span class="pl-c1">1</span>] <span class="pl-k">for</span> i <span class="pl-k">in</span> parse_range(<span class="pl-v">self</span>.args.steps)]
<span class="pl-c1">107</span>.                <span class="pl-k">else</span>:
<span class="pl-c1">108</span>.                    <span class="pl-k">raise</span> <span class="pl-c1">Exception</span>(<span class="pl-s"><span class="pl-pds">"</span>Error: step range <span class="pl-cce">\"</span><span class="pl-pds">"</span></span> <span class="pl-k">+</span> <span class="pl-v">self</span>.args.steps <span class="pl-k">+</span>
<span class="pl-c1">109</span>.                        <span class="pl-s"><span class="pl-pds">"</span><span class="pl-cce">\"</span> is invalid (should match \d+([,-]\d+)*)!<span class="pl-pds">"</span></span>)
<span class="pl-c1">110</span>.            <span class="pl-k">else</span>:
<span class="pl-c1">111</span>.                self.argparser.error(<span class="pl-s"><span class="pl-pds">"</span>argument -s/--steps is required!<span class="pl-pds">"</span></span>)
<span class="pl-c1">112</span>.            Creator(<span class="pl-v">self</span>.<span class="pl-c1">__class__</span>.<span class="pl-c1">__name__</span>, <span class="pl-v">self</span>._step_range) <span class="pl-c">#pass class name and step object list to Creator</span></pre></div>

<blockquote>
<p>In this case, My Creator Factory API has merged into MUGQICPipeline software, and it can output flowchart automatically when pipeline tool is called. </p>
</blockquote>

<h3>
<a id="flowchart-legend-for-mugqic_pipelines" class="anchor" href="#flowchart-legend-for-mugqic_pipelines" aria-hidden="true"><span aria-hidden="true" class="octicon octicon-link"></span></a>Flowchart legend for MUGQIC_PIPELINES</h3>

<p><strong>input/output node</strong>  </p>

<h4>
<a id="" class="anchor" href="#" aria-hidden="true"><span aria-hidden="true" class="octicon octicon-link"></span></a><img src="http://52.36.214.116/%7Ewangwei407/gsoc2016/input.png" alt="input.png">
</h4>

<p><strong>start/end node</strong>  </p>

<h4>
<a id="-1" class="anchor" href="#-1" aria-hidden="true"><span aria-hidden="true" class="octicon octicon-link"></span></a><img src="http://52.36.214.116/%7Ewangwei407/gsoc2016/step.png" alt="start.png">
</h4>

<p><strong>action node</strong>  </p>

<h4>
<a id="-2" class="anchor" href="#-2" aria-hidden="true"><span aria-hidden="true" class="octicon octicon-link"></span></a><img src="http://52.36.214.116/%7Ewangwei407/gsoc2016/action.png" alt="action.png">
</h4>

<h3>
<a id="flowchart-expected-outcomeselection-test" class="anchor" href="#flowchart-expected-outcomeselection-test" aria-hidden="true"><span aria-hidden="true" class="octicon octicon-link"></span></a>Flowchart expected outcome(selection test)</h3>

<h4>
<a id="selection-tests" class="anchor" href="#selection-tests" aria-hidden="true"><span aria-hidden="true" class="octicon octicon-link"></span></a><strong>Selection tests</strong>
</h4>

<p>Implement a test flochart in python for 5 first step of the DNAseq pipeline.
the corresponding step are:<br>
1. picard_sam_to_fastq =&gt; generate fastq files from bam files<br>
2. trimmomatic =&gt; clean fastq files<br>
3. merge_trimmomatic_stats =&gt; merge individuals cleaning metrics<br>
4. bwa_mem_picard_sort_sam =&gt; generate bam files from fastq files<br>
5. picard_merge_sam_files =&gt; merge individuals bam files  </p>

<h5>
<a id="my-flowchart-output" class="anchor" href="#my-flowchart-output" aria-hidden="true"><span aria-hidden="true" class="octicon octicon-link"></span></a><strong>My flowchart output</strong>
</h5>

<h5>
<a id="my-flowchart-creator-can-arrange-output-in-different-directions" class="anchor" href="#my-flowchart-creator-can-arrange-output-in-different-directions" aria-hidden="true"><span aria-hidden="true" class="octicon octicon-link"></span></a>My flowchart Creator can arrange output in different directions</h5>

<ol>
<li>LR (from left to right)<br>
</li>
</ol>

<p><img src="http://52.36.214.116/%7Ewangwei407/gsoc2016/outputLR.png" alt="outputLR.png"></p>

<ol>
<li>TB (from top to bottom)<br>
</li>
</ol>

<p><img src="http://52.36.214.116/%7Ewangwei407/gsoc2016/outputTB.png" alt="outputTB.png"></p>

<h5>
<a id="my-flowchart-creator-can-output-flowchart-based-on-different-step-range" class="anchor" href="#my-flowchart-creator-can-output-flowchart-based-on-different-step-range" aria-hidden="true"><span aria-hidden="true" class="octicon octicon-link"></span></a>My flowchart Creator can output flowchart based on different step range</h5>

<ol>
<li>Step (1-4) (To save the space, I use the 'LR' rank for flowchart)<br>
</li>
</ol>

<p><img src="http://52.36.214.116/%7Ewangwei407/gsoc2016/outputonefor.png" alt="outputonefor.png">
2. Step (3,4,5)  </p>

<p><img src="http://52.36.214.116/%7Ewangwei407/gsoc2016/output345.png" alt="output345.png"></p>

<h2>
<a id="timeline" class="anchor" href="#timeline" aria-hidden="true"><span aria-hidden="true" class="octicon octicon-link"></span></a>Timeline</h2>

<p>(consult GSOC schedule)</p>

<p>Provide a detailed timeline of how you plan to spend your summer, organized by deliverables.  Don't leave testing and documentation for last, as that's almost a guarantee of a failed project. </p>

<p>What is your contingency plan for things not going to schedule? </p>

<ul>
<li>
<strong>23 April</strong> Get to contact mentor and gather information about MUGQICPipeline, such as each pipeline steps details.</li>
<li>
<strong>23 May</strong> Begin coding for project.</li>
</ul>

<h3>
<a id="work-period" class="anchor" href="#work-period" aria-hidden="true"><span aria-hidden="true" class="octicon octicon-link"></span></a><strong>Work Period</strong>
</h3>

<ul>
<li>
<strong>23 May-28</strong> Design whole Flowchart Creator API.</li>
<li>
<strong>29 May-3 June</strong> Write documentation for API, including CreatorFactory class and each pipeline Creator class.</li>
<li>
<strong>4 June-6 June</strong> Design and write a test class to make sure that Flowchart Creator create correct start/end node (pipeline name, type, time) and correct sequence of steps. For example, for step list [1,3,4,6,7,19,30] output sequence: [1,3,4,6,7,19,30] is correct, sequence: [1,4,6,3,7,19,30] is wrong.</li>
<li>
<strong>7 June-11 June</strong> Write CreatorFactory class.</li>
<li>
<strong>12 June-18 June</strong> Write Creator classes for each pipeline, which has an order as follows:
<img src="http://52.36.214.116/%7Ewangwei407/gsoc2016/sequence.png" alt="sequence">
</li>
<li>
<strong>20 June</strong> Mentors and students can begin submitting mid-term evaluations.</li>
<li>
<strong>27 June</strong> Mid-term evaluations deadline</li>
<li>
<strong>28 June-August 10</strong> Finish the rest part of Creator for pipeline</li>
<li>
<strong>August 10-August 23</strong> Test Flowchart Creator API. Disscuss with MUGQICPipeline team to build the flowchart more concise and beautiful (modify node,edges shape and color and output path and etc.)</li>
</ul>

<h2>
<a id="management-of-coding-project" class="anchor" href="#management-of-coding-project" aria-hidden="true"><span aria-hidden="true" class="octicon octicon-link"></span></a>Management of Coding Project</h2>

<ul>
<li>Clone MUGQICPipeline to <a href="http://github.com/wangwei407">my respository</a>, and make a branch.</li>
<li>Every week, I will commit the change to the branch. I can test my API on local. And I will report test files to mentor and upload to my branch.</li>
<li>When I finished the whole API, I will make a pull request to MUGQICPipeline repository.</li>
</ul>

<h2>
<a id="test" class="anchor" href="#test" aria-hidden="true"><span aria-hidden="true" class="octicon octicon-link"></span></a>Test</h2>

<h4>
<a id="test-class-description" class="anchor" href="#test-class-description" aria-hidden="true"><span aria-hidden="true" class="octicon octicon-link"></span></a>Test Class description:</h4>

<ul>
<li>Randomly generate two ouput:<br>

<ol>
<li>class name for pipeline type. (e.g. DnaSeq,RnaSeq)<br>
</li>
<li>step object sequence list. For example, step[1,2,3,5,6,7,10,20]<br>
</li>
</ol>
</li>
<li>Then pass the output to Creator API.</li>
<li>Get the return of Creator API.</li>
<li>Check whether or not the class name is matched</li>
<li>Check whether or not the step output sequence is matched and correct.</li>
<li>Check whether the step is out of range for pipeline. (e.g. ChiSeq has total 15 steps if Creator receive a step list[1,2,3,4,16] it will raise an out of step range exception)</li>
</ul>

<h2>
<a id="anything-else" class="anchor" href="#anything-else" aria-hidden="true"><span aria-hidden="true" class="octicon octicon-link"></span></a>Anything Else</h2>

      <footer class="site-footer">
        <span class="site-footer-owner"><a href="https://github.com/wangwei407/GSOC2016-MUGQIC_PIPELINES--FLOWCHART-CREATOR">Gsoc2016-mugqic pipelines--flowchart-creator</a> is maintained by <a href="https://github.com/wangwei407">wangwei407</a>.</span>

        <span class="site-footer-credits">This page was generated by <a href="https://pages.github.com">GitHub Pages</a> using the <a href="https://github.com/jasonlong/cayman-theme">Cayman theme</a> by <a href="https://twitter.com/jasonlong">Jason Long</a>.</span>
      </footer>

    </section>

  
  </body>
</html>
